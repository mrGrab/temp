{"version":3,"file":"index.js","sources":["../src/context.js","../src/util.js","../src/SubmitValidationError.js","../src/DefaultStateProvider.js","../src/Form.js","../src/renderWrapper.js","../src/Field.js","../src/FieldArray.js","../src/withField.js","../src/index.js"],"sourcesContent":["// @flow strict\n\nimport * as React from 'react';\nimport type {Context} from './types';\n\nconst initialState: Context | null = null;\nexport const {Provider, Consumer} = React.createContext(initialState);\n","// @flow strict\n\n// flowlint unclear-type:off\n\nconst formatErrorPath = (path: Array<any>, more: boolean): string => {\n  return path\n    .map((val) => (typeof val === 'string' ? `\"${val}\"` : `${val}`))\n    .concat(more ? ['...'] : [])\n    .join(', ');\n};\n\nexport const pathError = () => 'Invalid path. Expected array or string.';\nexport const pathSyntaxError = (path: string) =>\n  `Invalid path. Syntax error at \"${path}\".`;\nexport const emptyPathError = () =>\n  'Invalid path. Expected non-empty array or string.';\nexport const emptyPathArrayError = () =>\n  'Invalid path. Expected non-empty array.';\nexport const emptyPathStringError = () =>\n  'Invalid path. Expected non-empty string.';\nexport const arrayTargetError = () => 'Invalid target. Expected array.';\nexport const indexError = () => 'Invalid index. Expected int.';\nexport const boundsError = () => 'Invalid index. Out of bounds.';\nexport const pathArrayError = () => 'Invalid path. Expected array.';\nexport const expectedArrayError = (\n  value: any,\n  path: Array<any>,\n  more: boolean,\n) =>\n  `Invalid value. Expected array at path: [ ${formatErrorPath(\n    path,\n    more,\n  )} ]. Encountered value: ${value}.`;\nexport const expectedPathIntError = (path: Array<any>, more: boolean) =>\n  `Invalid path part. Expected int at path: [ ${formatErrorPath(\n    path,\n    more,\n  )} ].`;\nexport const pathPartError = (path: Array<any>, more: boolean) =>\n  `Invalid path part. Expected string or int at path: [ ${formatErrorPath(\n    path,\n    more,\n  )} ].`;\n\nexport const isValidPath = (path: mixed): boolean %checks => {\n  return (\n    (Array.isArray(path) && path.length !== 0) ||\n    (typeof path === 'string' && path !== '')\n  );\n};\n\nexport const isInt = (val: mixed): boolean %checks => {\n  return typeof val === 'number' && val === (val | 0);\n};\n\nexport const insert = <T>(\n  array: Array<T>,\n  index: number,\n  value: T,\n): Array<T> => {\n  if (!Array.isArray(array)) {\n    throw new TypeError(arrayTargetError());\n  }\n\n  if (!isInt(index)) {\n    throw new TypeError(indexError());\n  }\n\n  if (index < 0 || index > array.length) {\n    throw new TypeError(boundsError());\n  }\n\n  return array.slice(0, index).concat([value], array.slice(index));\n};\n\nexport const remove = <T>(array: Array<T>, index: number): Array<T> => {\n  if (!Array.isArray(array)) {\n    throw new TypeError(arrayTargetError());\n  }\n\n  if (!isInt(index)) {\n    throw new TypeError(indexError());\n  }\n\n  if (index < 0 || index >= array.length) {\n    throw new TypeError(boundsError());\n  }\n\n  return array.slice(0, index).concat(array.slice(index + 1));\n};\n\nexport const equals = (a: any, b: any): boolean => {\n  if (a === b) {\n    return true;\n  }\n  // eslint-disable-next-line no-self-compare\n  if (a !== a && b !== b) {\n    return true;\n  }\n  if (a instanceof Date && b instanceof Date && a.getTime() === b.getTime()) {\n    return true;\n  }\n  return false;\n};\n\nexport const formatPath = (path: Array<string | number> | string): string => {\n  if (typeof path === 'string') {\n    return path;\n  }\n\n  if (Array.isArray(path)) {\n    let result = '';\n\n    path.forEach((part) => {\n      if (isInt(part)) {\n        result += `[${part}]`;\n      } else if (result) {\n        result += `.${part}`;\n      } else {\n        result = part;\n      }\n    });\n\n    return result;\n  }\n\n  throw new TypeError(pathError());\n};\n\nexport const parsePath = (\n  path: Array<string | number> | string,\n): Array<string | number> => {\n  if (Array.isArray(path)) {\n    return path;\n  }\n\n  if (typeof path === 'string') {\n    return path.split('.').reduce((result, part) => {\n      if (part === '' && result.length === 0) {\n        return result;\n      }\n\n      const split = part.split('[');\n      const key = split[0];\n      const rest = split.slice(1);\n\n      return result.concat(\n        key === '' ? [] : [key],\n        rest.map((i) => {\n          const match = /^([0-9]+)\\]$/.exec(i);\n          if (!match) {\n            throw new TypeError(\n              pathSyntaxError(formatPath(result.concat([part]))),\n            );\n          }\n          return parseInt(match[1], 10);\n        }),\n      );\n    }, []);\n  }\n\n  throw new TypeError(pathError());\n};\n\nconst _setWith = <T>(\n  value: T,\n  path: Array<string | number>,\n  updater: (any) => any,\n  currentPath: Array<string | number> = [],\n): T => {\n  if (!Array.isArray(path)) {\n    throw pathArrayError();\n  }\n\n  if (!path.length) {\n    return updater(value);\n  }\n\n  const key = path[0];\n  const intKey = isInt(key) ? key : null;\n\n  if (intKey === null && typeof key !== 'string') {\n    throw new TypeError(\n      pathPartError(currentPath.concat([key]), path.length > 1),\n    );\n  }\n\n  const nextValue = value !== undefined ? (value: any)[key] : undefined;\n  const updateResult =\n    path.length === 1\n      ? updater(nextValue)\n      : _setWith(nextValue, path.slice(1), updater, currentPath.concat[key]);\n\n  if (intKey !== null) {\n    if (Array.isArray(value) || value === undefined) {\n      if (value && equals(updateResult, value[intKey])) {\n        // The correct value is already in place, abort update.\n        return value;\n      }\n\n      const result = value ? value.slice(0) : [];\n      while (result.length <= intKey) {\n        result.push(undefined);\n      }\n\n      result.splice(intKey, 1, updateResult);\n      return (result: any);\n    }\n\n    throw new TypeError(\n      expectedArrayError(value, currentPath.concat([key]), path.length > 1),\n    );\n  } else if (Array.isArray(value)) {\n    throw new TypeError(\n      expectedPathIntError(currentPath.concat([key]), path.length > 1),\n    );\n  }\n\n  if (\n    value !== null &&\n    value !== undefined &&\n    equals(updateResult, (value: any)[key])\n  ) {\n    // The correct value is already in place, abort update.\n    return value;\n  }\n\n  const result = Object.assign({}, value);\n  result[path[0]] = updateResult;\n  return result;\n};\n\nexport const setWith = <T>(\n  object: T,\n  path: Array<string | number>,\n  updater: (mixed) => mixed,\n): T => _setWith(object, path, updater);\n\nexport const set = <T>(\n  object: T,\n  path: Array<string | number>,\n  value: mixed,\n): T => _setWith(object, path, () => value);\n\nexport const get = (\n  value: any,\n  path: Array<string | number>,\n  currentPath: Array<string | number> = [],\n): mixed => {\n  if (!Array.isArray(path)) {\n    throw new TypeError(pathArrayError());\n  }\n\n  if (!path.length) {\n    return value;\n  }\n\n  const key = path[0];\n  const keyIsInt = isInt(key);\n  const valueIsArray = Array.isArray(value);\n  const valueIsUndefined = value === undefined;\n\n  if (!keyIsInt && typeof key !== 'string') {\n    throw new TypeError(\n      pathPartError(currentPath.concat([key]), path.length > 1),\n    );\n  }\n\n  if ((keyIsInt || valueIsUndefined) !== (valueIsArray || valueIsUndefined)) {\n    throw new TypeError(\n      keyIsInt\n        ? expectedArrayError(value, currentPath.concat([key]), path.length > 1)\n        : expectedPathIntError(currentPath.concat([key]), path.length > 1),\n    );\n  }\n\n  return get(\n    valueIsUndefined ? undefined : value[key],\n    path.slice(1),\n    currentPath.concat[key],\n  );\n};\n\nexport const matchesDeep = (value: any, test: (mixed) => boolean): boolean => {\n  if (test(value)) {\n    return true;\n  }\n\n  if (Array.isArray(value)) {\n    for (let i = 0; i < value.length; i += 1) {\n      if (matchesDeep(value[i], test)) return true;\n    }\n  }\n\n  if (/^\\[object Object\\]$/.test(Object.prototype.toString.call(value))) {\n    // eslint-disable-next-line no-restricted-syntax\n    for (const key in value) {\n      if (Object.prototype.hasOwnProperty.call(value, key)) {\n        if (matchesDeep(value[key], test)) {\n          return true;\n        }\n      }\n    }\n  }\n\n  return false;\n};\n\nexport const hasValue = (value: mixed) =>\n  matchesDeep(\n    value,\n    (value) =>\n      !/^\\[object (Object|Array|Undefined)\\]$/.test(\n        Object.prototype.toString.call(value),\n      ),\n  );\n\nexport const isEvent = (_event: mixed): boolean => {\n  // Duck-type Event and SyntheticEvent instances\n  return (\n    _event !== null &&\n    typeof _event === 'object' &&\n    typeof _event.stopPropagation === 'function' &&\n    typeof _event.preventDefault === 'function'\n  );\n};\n\nexport const castEvent = <T>(\n  event: mixed,\n): Event | SyntheticEvent<T> | null => {\n  return isEvent(event) ? (event: any) : null;\n};\n\nexport const mergeHandlers = (\n  h1: ((mixed) => mixed) | void,\n  h2: (mixed) => void,\n) => {\n  return (eventOrValue: mixed): void => {\n    if (h1) {\n      h1(eventOrValue);\n\n      const event = castEvent(eventOrValue);\n      if (event !== null && event.defaultPrevented) {\n        return;\n      }\n    }\n\n    h2(eventOrValue);\n  };\n};\n\nexport const createParseEvent = (HTMLElementClass: Function) => {\n  return (eventOrValue: mixed): mixed => {\n    const event = castEvent(eventOrValue);\n\n    if (!event) {\n      return eventOrValue;\n    }\n\n    if (event.target instanceof HTMLElementClass) {\n      const type = event.target.type;\n\n      if (type === 'checkbox') {\n        return !!event.target.checked;\n      }\n\n      // TODO: Parse additional event types: file, multiple-select, etc.\n\n      return event.target.value;\n    }\n\n    return undefined;\n  };\n};\n\nexport const parseEvent = createParseEvent(HTMLElement);\n","// @flow strict\n\nimport ExtendableError from 'es6-error';\nimport type {State} from './types';\n\nexport default class SubmitValidationError extends ExtendableError {\n  errors: State | null;\n  original: Error | void;\n\n  constructor(errors: State, original?: Error) {\n    super('Submit Validation Failed');\n\n    if (typeof errors === 'object' && !Array.isArray(errors)) {\n      this.errors = errors;\n    } else {\n      this.errors = null;\n    }\n\n    this.original = original;\n  }\n}\n","// @flow strict\n\nimport * as React from 'react';\n\nimport type {\n  DefaultStateProviderProps,\n  Context,\n  PathArray,\n  Path,\n} from './types';\n\nimport {\n  set,\n  setWith,\n  parsePath,\n  formatPath,\n  emptyPathArrayError,\n  emptyPathStringError,\n  hasValue,\n} from './util';\nimport SubmitValidationError from './SubmitValidationError';\n\ntype Props<T> = DefaultStateProviderProps<T>;\ntype State = {_props: *} & Context;\n\nconst updateWarningState = (state: State) => {\n  let nextState: State = state;\n\n  if (!hasValue(nextState.warningState)) {\n    nextState = set(nextState, ['warningState'], null);\n  }\n\n  return nextState;\n};\n\nconst updateErrorState = (state: State) => {\n  let nextState: State = state;\n\n  if (!hasValue(nextState.errorState)) {\n    nextState = set(nextState, ['errorState'], null);\n  }\n\n  return nextState;\n};\n\nconst updateSubmitErrorState = (state: State) => {\n  let nextState: State = state;\n\n  if (!hasValue(nextState.submitErrorState)) {\n    nextState = set(nextState, ['submitErrorState'], null);\n  }\n\n  return nextState;\n};\n\nconst runWarn = <T>(state: State, props: Props<T>) => {\n  let nextState: State = state;\n\n  const warningState = props.warn(state.valueState) || null;\n\n  nextState = set(nextState, ['warningState'], warningState);\n\n  if (nextState.warningState !== state.warningState) {\n    nextState = updateWarningState(nextState);\n  }\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nconst runValidate = <T>(state: State, props: Props<T>) => {\n  let nextState: State = state;\n\n  const errorState = props.validate(state.valueState) || null;\n\n  nextState = set(nextState, ['errorState'], errorState);\n\n  if (nextState.errorState !== state.errorState) {\n    nextState = updateErrorState(nextState);\n  }\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nconst updateValue = (path: PathArray, value: mixed) => <T>(\n  state: State,\n  props: Props<T>,\n) => {\n  if (path.length < 1) {\n    throw new TypeError(emptyPathArrayError());\n  }\n\n  let nextState: State = state;\n\n  nextState = set(nextState, ['valueState'].concat(path), value);\n\n  if (nextState === state) {\n    return null;\n  }\n\n  nextState = runWarn(nextState, props) || nextState;\n  nextState = runValidate(nextState, props) || nextState;\n  nextState = set(nextState, ['submitErrorState'], null);\n\n  return nextState;\n};\n\nconst updateInitialValue = (path: PathArray, value: mixed) => (\n  state: State,\n) => {\n  if (path.length < 1) {\n    throw new TypeError(emptyPathArrayError());\n  }\n\n  let nextState: State = state;\n\n  nextState = set(nextState, ['initialValueState'].concat(path), value);\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nconst updatePendingValue = (path: PathArray, value: mixed) => (\n  state: State,\n) => {\n  if (path.length < 1) {\n    throw new TypeError(emptyPathArrayError());\n  }\n\n  let nextState: State = state;\n\n  nextState = set(nextState, ['pendingValueState'].concat(path), value);\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nconst updateVisited = (key: string, visited: boolean) => (state: State) => {\n  if (key.length < 1) {\n    throw new TypeError(emptyPathStringError());\n  }\n\n  let nextState: State = state;\n\n  const updater = (currentVisited) => {\n    return !!currentVisited === visited ? currentVisited : visited;\n  };\n\n  nextState = setWith(nextState, ['visitedMap', key], updater);\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nconst updateTouched = (key: string, touched: boolean) => (state: State) => {\n  if (key.length < 1) {\n    throw new TypeError(emptyPathStringError());\n  }\n  let nextState: State = state;\n\n  const updater = (currentTouched) => {\n    return !!currentTouched === touched ? currentTouched : touched;\n  };\n\n  nextState = setWith(nextState, ['touchedMap', key], updater);\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nconst updateFocused = (key: string, focused: boolean) => (state: State) => {\n  if (key.length < 1) {\n    throw new TypeError(emptyPathStringError());\n  }\n\n  if (focused) {\n    if (state.focusedPath === key) {\n      return null;\n    }\n\n    return {focusedPath: key};\n  }\n\n  if (state.focusedPath !== key) {\n    return null;\n  }\n\n  return {focusedPath: null};\n};\n\nconst updateSubmit = (error?: Error) => (state: State) => {\n  let nextState: State = state;\n\n  nextState = set(nextState, ['submitting'], false);\n  nextState = set(nextState, ['submitSucceeded'], !error);\n  nextState = set(nextState, ['submitFailed'], !!error);\n\n  let submitErrorState;\n\n  if (error && error instanceof SubmitValidationError) {\n    submitErrorState = error.errors;\n  } else {\n    submitErrorState = null;\n  }\n\n  nextState = set(nextState, ['submitErrorState'], submitErrorState);\n  nextState = updateSubmitErrorState(nextState);\n\n  return nextState;\n};\n\nclass DefaultStateProvider<T> extends React.PureComponent<Props<T>, State> {\n  static defaultProps: typeof DefaultStateProvider.defaultProps;\n  static getDerivedStateFromProps: typeof DefaultStateProvider.getDerivedStateFromProps;\n\n  _willUnmount: boolean;\n\n  setValue(path: Path, value: mixed) {\n    this.setState(updateValue(parsePath(path), value));\n  }\n\n  setInitialValue(path: Path, value: mixed) {\n    this.setState(updateInitialValue(parsePath(path), value));\n  }\n\n  setPendingValue(path: Path, value: mixed) {\n    this.setState(updatePendingValue(parsePath(path), value));\n  }\n\n  setVisited(path: Path, visited: boolean) {\n    this.setState(updateVisited(formatPath(path), visited));\n  }\n\n  setTouched(path: Path, touched: boolean) {\n    this.setState(updateTouched(formatPath(path), touched));\n  }\n\n  setFocused(path: Path, focused: boolean) {\n    this.setState(updateFocused(formatPath(path), focused));\n  }\n\n  submit(event?: Event | SyntheticEvent<>) {\n    if (event) {\n      event.preventDefault();\n    }\n\n    let promise: Promise<T>;\n\n    const setState = (update) =>\n      new Promise(\n        (resolve) =>\n          this._willUnmount ? resolve() : this.setState(update, resolve),\n      );\n\n    setState((state, props) => {\n      if (state.submitting) {\n        promise = Promise.reject(\n          new Error('Form submit blocked pending current submit resolution.'),\n        );\n        return null;\n      }\n\n      if (state.errorState !== null) {\n        promise = Promise.reject(new SubmitValidationError(state.errorState));\n        return null;\n      }\n\n      promise = Promise.resolve(state.valueState).then(props.onSubmit);\n\n      return set(state, ['submitting'], true);\n    }).then(() => {\n      promise.then(\n        (result) =>\n          setState(updateSubmit()).then(() =>\n            this.props.onSubmitSuccess(result),\n          ),\n        (error) =>\n          setState(updateSubmit(error)).then(\n            () =>\n              error instanceof SubmitValidationError\n                ? this.props.onSubmitValidationFail(error)\n                : this.props.onSubmitFail(error),\n          ),\n      );\n    });\n  }\n\n  getInitialState() {\n    let state = {\n      initialValueState: this.props.values,\n      valueState: this.props.values,\n      pendingValueState: this.props.values,\n      warningState: null,\n      errorState: null,\n      submitErrorState: null,\n      focusedPath: null,\n      touchedMap: {},\n      visitedMap: {},\n      submitting: false,\n      submitFailed: false,\n      submitSucceeded: false,\n\n      actions: {\n        setValue: this.setValue.bind(this),\n        setInitialValue: this.setInitialValue.bind(this),\n        setPendingValue: this.setPendingValue.bind(this),\n        setTouched: this.setTouched.bind(this),\n        setVisited: this.setVisited.bind(this),\n        setFocused: this.setFocused.bind(this),\n        submit: this.submit.bind(this),\n      },\n\n      // Cache prop values for comparison in getDerivedStateFromProps\n      _props: {\n        warn: this.props.warn,\n        validate: this.props.validate,\n      },\n    };\n\n    state = runValidate(state, this.props) || state;\n    state = runWarn(state, this.props) || state;\n\n    return state;\n  }\n\n  componentWillUnmount() {\n    this._willUnmount = true;\n  }\n\n  constructor(props: Props<T>) {\n    super(props);\n    this._willUnmount = false;\n    this.state = this.getInitialState();\n  }\n\n  render() {\n    const {children} = this.props;\n    return children(this.state);\n  }\n}\n\nDefaultStateProvider.defaultProps = {\n  values: {},\n  onSubmit: () => {},\n  onSubmitFail: (error: Error) => Promise.reject(error),\n  onSubmitSuccess: () => {},\n  onSubmitValidationFail: () => {},\n  warn: () => null,\n  validate: () => null,\n};\n\nDefaultStateProvider.getDerivedStateFromProps = <T>(\n  props: Props<T>,\n  state: State,\n) => {\n  let nextState: State = state;\n\n  nextState = set(nextState, ['pendingValueState'], props.values);\n\n  if (props.validate !== state._props.validate) {\n    nextState = set(nextState, ['_props', 'validate'], props.validate);\n    nextState = runValidate(nextState, props) || nextState;\n  }\n\n  if (props.warn !== state._props.warn) {\n    nextState = set(nextState, ['_props', 'warn'], props.warn);\n    nextState = runWarn(nextState, props) || nextState;\n  }\n\n  if (nextState === state) {\n    return null;\n  }\n\n  return nextState;\n};\n\nexport default DefaultStateProvider;\n","// @flow strict\n\nimport * as React from 'react';\n\nimport type {\n  FormProps,\n  FormWrapperProps,\n  Context,\n  FormActions,\n  Path,\n} from './types';\n\nimport {Provider} from './context';\n\nimport DefaultStateProvider from './DefaultStateProvider';\n\ntype DefaultStateProviderConfig = React.ElementConfig<\n  typeof DefaultStateProvider,\n>;\nfunction defaultStateProviderProp(\n  config: DefaultStateProviderConfig,\n  render: (context: Context) => React.Node,\n) {\n  return <DefaultStateProvider {...config}>{render}</DefaultStateProvider>;\n}\n\nclass FormWrapper extends React.PureComponent<FormWrapperProps> {\n  render() {\n    return this.props.children(\n      Object.assign({}, this.props.actions, {\n        submitting: this.props.submitting,\n        submitFailed: this.props.submitFailed,\n        submitSucceeded: this.props.submitSucceeded,\n        hasErrors: this.props.hasErrors,\n        hasSubmitErrors: this.props.hasSubmitErrors,\n        hasWarnings: this.props.hasWarnings,\n      }),\n    );\n  }\n}\n\nclass Form<StateProviderProps>\n  extends React.PureComponent<FormProps<StateProviderProps>, Context>\n  implements FormActions {\n  static defaultProps: typeof Form.defaultProps;\n\n  _lastSetActions: ?FormActions;\n  setValue: (path: Path, value: mixed) => void;\n  setInitialValue: (path: Path, value: mixed) => void;\n  setPendingValue: (path: Path, value: mixed) => void;\n  setTouched: (path: Path, touched: boolean) => void;\n  setVisited: (path: Path, visited: boolean) => void;\n  setFocused: (path: Path, focused: boolean) => void;\n  submit: (event?: Event | SyntheticEvent<>) => void;\n\n  render() {\n    return this.props.stateProvider(this.props, (context: Context) => {\n      if (this._lastSetActions !== context.actions) {\n        Object.assign(this, context.actions);\n        this._lastSetActions = context.actions;\n      }\n      return (\n        <Provider value={context}>\n          <FormWrapper\n            actions={context.actions}\n            submitting={context.submitting}\n            submitFailed={context.submitFailed}\n            submitSucceeded={context.submitSucceeded}\n            hasErrors={context.errorState !== null}\n            hasSubmitErrors={context.submitErrorState !== null}\n            hasWarnings={context.warningState !== null}\n          >\n            {this.props.children}\n          </FormWrapper>\n        </Provider>\n      );\n    });\n  }\n}\n\nForm.defaultProps = {\n  stateProvider: defaultStateProviderProp,\n};\n\nexport default Form;\n","// @flow strict\n\nimport * as React from 'react';\n\nimport type {Path, FormActions, Context, FieldStateProps} from './types';\nimport {get, parsePath, formatPath} from './util';\n\nconst renderWrapper = <P: {path: Path}>(\n  Wrapper: React.ComponentType<P & FieldStateProps & FormActions>,\n  context: Context,\n  props: P,\n) => {\n  const parsedPath = parsePath(props.path);\n  const formattedPath = formatPath(props.path);\n\n  const {\n    initialValueState,\n    valueState,\n    pendingValueState,\n    warningState,\n    errorState,\n    submitErrorState,\n    focusedPath,\n    touchedMap,\n    visitedMap,\n    submitting,\n    submitFailed,\n    submitSucceeded,\n    actions,\n  } = context;\n\n  const warning =\n    warningState !== null ? get(warningState, parsedPath) : undefined;\n\n  let error =\n    submitErrorState !== null ? get(submitErrorState, parsedPath) : undefined;\n\n  if ((error === undefined || error === null) && errorState !== null) {\n    error = get(errorState, parsedPath);\n  }\n\n  return (\n    <Wrapper\n      {...props}\n      initialValue={get(initialValueState, parsedPath)}\n      value={get(valueState, parsedPath)}\n      pendingValue={get(pendingValueState, parsedPath)}\n      warning={warning}\n      error={error}\n      focused={focusedPath === formattedPath}\n      touched={!!touchedMap[formattedPath]}\n      visited={!!visitedMap[formattedPath]}\n      submitting={submitting}\n      submitFailed={submitFailed}\n      submitSucceeded={submitSucceeded}\n      {...actions}\n    />\n  );\n};\n\nexport default renderWrapper;\n","// @flow strict\n\nimport * as React from 'react';\n\nimport type {FieldProps, FieldWrapperProps, InputProps} from './types';\nimport {\n  parsePath,\n  formatPath,\n  parseEvent,\n  mergeHandlers,\n  hasValue,\n} from './util';\nimport {Consumer} from './context';\nimport renderWrapper from './renderWrapper';\n\ntype HandlerProps = {\n  onFocus: (mixed) => mixed,\n  onBlur: (mixed) => mixed,\n  onChange: (mixed) => mixed,\n};\n\nclass FieldWrapper extends React.PureComponent<FieldWrapperProps> {\n  render() {\n    const {\n      // Field Config\n      path,\n      format,\n      parse,\n      compare,\n      checkbox,\n\n      // Field state\n      initialValue,\n      value,\n      pendingValue,\n      error,\n      warning,\n      focused,\n      touched,\n      visited,\n      submitting,\n      submitFailed,\n      submitSucceeded,\n\n      // Context Actions\n      setFocused,\n      setVisited,\n      setTouched,\n      setValue,\n      setInitialValue,\n      setPendingValue,\n      submit,\n\n      // FieldArray Props\n      index,\n      addField,\n      removeField,\n\n      // Render Callbacks\n      children,\n    } = this.props;\n\n    const parsedPath = parsePath(path);\n    const formattedPath = formatPath(path);\n\n    const dirty = !compare(value, initialValue);\n    const detached = !compare(value, pendingValue);\n\n    const hasError = hasValue(error);\n    const hasWarning = hasValue(warning);\n\n    const focus = (focused: boolean) => setFocused(formattedPath, focused);\n    const visit = (visited: boolean) => setVisited(formattedPath, visited);\n    const touch = (touched: boolean) => setTouched(formattedPath, touched);\n    const change = (nextValue) => {\n      const parsedValue = parse(nextValue, value);\n\n      if (!detached) {\n        setPendingValue(parsedPath, parsedValue);\n      }\n\n      setValue(parsedPath, parsedValue);\n    };\n\n    const input = {\n      name: formattedPath,\n      value: checkbox ? undefined : format(value),\n      checked: checkbox ? !!format(value) : undefined,\n      onFocus() {\n        focus(true);\n        visit(true);\n      },\n      onBlur() {\n        focus(false);\n        touch(true);\n      },\n      onChange(eventOrValue) {\n        change(parseEvent(eventOrValue));\n      },\n    };\n\n    const composeInput = <P: $Shape<HandlerProps>>(\n      userProps: P,\n    ): $Rest<P, $Exact<HandlerProps>> & InputProps =>\n      Object.assign({}, (userProps: $Rest<P, $Exact<HandlerProps>>), input, {\n        onFocus: mergeHandlers(userProps.onFocus, input.onFocus),\n        onBlur: mergeHandlers(userProps.onBlur, input.onBlur),\n        onChange: mergeHandlers(userProps.onChange, input.onChange),\n      });\n\n    let arrayActions;\n\n    if (addField && removeField && typeof index === 'number') {\n      arrayActions = {\n        addFieldBefore(value) {\n          addField(index, value);\n        },\n        addFieldAfter(value) {\n          addField(index + 1, value);\n        },\n        removeField() {\n          removeField(index);\n        },\n      };\n    }\n\n    return children(\n      Object.assign(\n        {\n          // Input Tag Props\n          input,\n          composeInput,\n\n          // \"Meta\" Props\n          path: formattedPath,\n          hasError,\n          error,\n          hasWarning,\n          warning,\n          focused,\n          touched,\n          visited,\n          dirty,\n          pristine: !dirty,\n          submitting,\n          submitFailed,\n          submitSucceeded,\n          initialValue,\n          rawValue: value,\n          pendingValue,\n          detached,\n\n          // Context Actions\n          setFocused: focus,\n          setVisited: visit,\n          setTouched: touch,\n          setValue: change,\n          acceptPendingValue() {\n            setValue(parsedPath, pendingValue);\n            setInitialValue(parsedPath, pendingValue);\n          },\n          rejectPendingValue() {\n            setPendingValue(parsedPath, value);\n            setInitialValue(parsedPath, pendingValue);\n          },\n          submit,\n\n          addFieldBefore: undefined,\n          addFieldAfter: undefined,\n          removeField: undefined,\n        },\n        arrayActions,\n      ),\n    );\n  }\n}\n\nclass Field extends React.PureComponent<FieldProps> {\n  static defaultProps: typeof Field.defaultProps;\n\n  render() {\n    const {path, format, parse, compare, checkbox, children} = this.props;\n\n    return (\n      <Consumer>\n        {(context) =>\n          context !== null &&\n          renderWrapper(FieldWrapper, context, {\n            path,\n            format,\n            parse,\n            compare,\n            checkbox,\n            children,\n          })\n        }\n      </Consumer>\n    );\n  }\n}\n\nField.defaultProps = {\n  format: (v: mixed) => {\n    if (v === null || v === undefined) {\n      return '';\n    }\n\n    return v;\n  },\n  parse: (v: mixed) => v,\n  compare: (value, otherValue) => {\n    return value === otherValue;\n  },\n  checkbox: false,\n};\n\nexport default Field;\n","// @flow strict\n\nimport * as React from 'react';\n\nimport type {\n  FieldArrayProps,\n  FieldArrayWrapperProps,\n  FieldArrayRenderProps,\n} from './types';\nimport {parsePath, formatPath, insert, remove, hasValue} from './util';\nimport {Consumer} from './context';\nimport Field from './Field';\nimport renderWrapper from './renderWrapper';\n\nclass FieldArrayWrapper extends React.PureComponent<FieldArrayWrapperProps> {\n  static defaultProps: typeof FieldArrayWrapper.defaultProps;\n\n  addField(index: number, fieldValue: mixed) {\n    const {value: values, path, setValue} = this.props;\n\n    const parsedPath = parsePath(path);\n\n    if (Array.isArray(values)) {\n      setValue(parsedPath, insert(values, index, fieldValue));\n    }\n  }\n\n  removeField(index: number) {\n    const {value: values, path, setValue} = this.props;\n\n    const parsedPath = parsePath(path);\n\n    if (Array.isArray(values)) {\n      setValue(parsedPath, remove(values, index));\n    }\n  }\n\n  render() {\n    const {\n      // Field Config\n      path,\n      format,\n      parse,\n      checkbox,\n\n      // Field state\n      initialValue: initialValues,\n      value: values,\n      pendingValue: pendingValues,\n      error: errors,\n      warning: warnings,\n      submitting,\n      submitFailed,\n      submitSucceeded,\n\n      // Context Actions\n      submit,\n\n      // Render Callbacks\n      children,\n      renderField,\n      getFieldKey,\n    } = this.props;\n\n    const parsedPath = parsePath(path);\n    const formattedPath = formatPath(path);\n\n    if (!Array.isArray(values)) {\n      throw new Error(`expected array value at ${formattedPath}`);\n    }\n\n    if (!Array.isArray(pendingValues)) {\n      throw new Error(`expected array pendingValue at ${formattedPath}`);\n    }\n\n    if (!Array.isArray(warnings)) {\n      throw new Error(`expected array warnings at ${formattedPath}`);\n    }\n\n    if (!Array.isArray(errors)) {\n      throw new Error(`expected array error at ${formattedPath}`);\n    }\n\n    const fields = values.map((value, index) => {\n      const parsedFieldPath = parsedPath.concat([index]);\n\n      return (\n        <Field\n          index={index}\n          key={getFieldKey(value, index)}\n          path={parsedFieldPath}\n          format={format}\n          parse={parse}\n          checkbox={checkbox}\n          addField={this.addField.bind(this)}\n          removeField={this.removeField.bind(this)}\n        >\n          {renderField}\n        </Field>\n      );\n    });\n\n    // TODO: Calculate dirty/detached state with shallow array equality,\n    // potentially with deep equality. Maybe provide a callback to allow the\n    // consumer to provide a compare func?\n    const hasErrors = hasValue(errors);\n    const hasWarnings = hasValue(warnings);\n\n    return children({\n      fields,\n\n      // \"Meta\" Props\n      path: formattedPath,\n      hasErrors,\n      errors,\n      hasWarnings,\n      warnings,\n      submitting,\n      submitFailed,\n      submitSucceeded,\n      initialValues,\n      rawValues: values,\n      pendingValues,\n\n      // Context Actions\n      submit,\n\n      // FieldArray Actions\n      addField(value) {\n        this.addField(fields.length, value);\n      },\n    });\n  }\n}\n\nFieldArrayWrapper.defaultProps = {\n  initialValue: [],\n  value: [],\n  pendingValue: [],\n  error: [],\n  warning: [],\n  submitError: [],\n};\n\nclass FieldArray extends React.PureComponent<FieldArrayProps> {\n  static defaultProps: typeof FieldArray.defaultProps;\n\n  render() {\n    const {\n      path,\n      format,\n      parse,\n      checkbox,\n      renderField,\n      children,\n      getFieldKey,\n    } = this.props;\n\n    return (\n      <Consumer>\n        {(context) =>\n          context !== null &&\n          renderWrapper(FieldArrayWrapper, context, {\n            path,\n            format,\n            parse,\n            checkbox,\n            renderField,\n            children,\n            getFieldKey,\n          })\n        }\n      </Consumer>\n    );\n  }\n}\n\nFieldArray.defaultProps = {\n  children: ({fields}: FieldArrayRenderProps) => fields,\n  getFieldKey: (stateValue: mixed, index: number) => `${index}`,\n};\n\nexport default FieldArray;\n","// @flow strict\n\nimport * as React from 'react';\n// flowlint untyped-import:off\nimport hoistStatics from 'hoist-non-react-statics';\n// flowlint untyped-import:error\n\nimport type {FieldRenderProps} from './types';\nimport {isValidPath, emptyPathError} from './util';\nimport Field from './Field';\n\nconst withField = <P: string>(\n  propName: P,\n  config: $Diff<React.ElementConfig<typeof Field>, {children: *}>,\n) => <T, R: {[P]: FieldRenderProps} & T>(\n  Component: React.ComponentType<T>,\n): React.ComponentType<R> => {\n  if (typeof propName !== 'string') {\n    throw new TypeError('Invalid withField prop name. Expected string.');\n  }\n\n  if (!config || typeof config !== 'object') {\n    throw new TypeError('Invalid withField config. Expected object.');\n  }\n\n  if (!isValidPath(config.path)) {\n    throw new TypeError(emptyPathError());\n  }\n\n  class WithField extends React.PureComponent<R> {\n    render() {\n      return (\n        <Field {...config}>\n          {(fieldProps: FieldRenderProps) => {\n            const props = {};\n            props[propName] = fieldProps;\n            return <Component {...props} {...this.props} />;\n          }}\n        </Field>\n      );\n    }\n  }\n\n  return hoistStatics(WithField, Component);\n};\n\nexport default withField;\n","// @flow strict\n\nexport {default} from './Form';\n\nexport {default as Field} from './Field';\nexport {default as FieldArray} from './FieldArray';\nexport {default as Form} from './Form';\nexport {default as SubmitValidationError} from './SubmitValidationError';\nexport {default as withField} from './withField';\nexport {get, set, parsePath, formatPath} from './util';\n\nexport type {\n  State,\n  PathArray,\n  Path,\n  FormActions,\n  Context,\n  DefaultStateProviderProps,\n  StateProvider,\n  FormProps,\n  FormWrapperProps,\n  InputProps,\n  FieldRenderProps,\n  FieldArrayRenderProps,\n  FieldConfig,\n  FieldProps,\n  FieldArrayProps,\n  FieldWrapperProps,\n  FieldArrayWrapperProps,\n} from './types';\n"],"names":["initialState","React","Provider","Consumer","formatErrorPath","path","more","map","val","concat","join","pathError","pathSyntaxError","emptyPathError","emptyPathArrayError","emptyPathStringError","arrayTargetError","indexError","boundsError","pathArrayError","expectedArrayError","value","expectedPathIntError","pathPartError","isValidPath","Array","isArray","length","isInt","insert","array","index","TypeError","slice","remove","equals","a","b","Date","getTime","formatPath","result","forEach","part","parsePath","split","reduce","key","rest","i","match","exec","parseInt","_setWith","updater","currentPath","intKey","nextValue","undefined","updateResult","push","splice","setWith","object","set","get","keyIsInt","valueIsArray","valueIsUndefined","matchesDeep","test","Object","prototype","toString","call","hasOwnProperty","hasValue","isEvent","_event","stopPropagation","preventDefault","castEvent","event","mergeHandlers","h1","h2","eventOrValue","defaultPrevented","createParseEvent","HTMLElementClass","target","type","checked","parseEvent","HTMLElement","SubmitValidationError","errors","original","ExtendableError","updateWarningState","state","nextState","warningState","updateErrorState","errorState","updateSubmitErrorState","submitErrorState","runWarn","props","warn","valueState","runValidate","validate","updateValue","updateInitialValue","updatePendingValue","updateVisited","visited","currentVisited","updateTouched","touched","currentTouched","updateFocused","focused","focusedPath","updateSubmit","error","DefaultStateProvider","setState","promise","update","Promise","resolve","_willUnmount","submitting","reject","Error","then","onSubmit","onSubmitSuccess","onSubmitValidationFail","onSubmitFail","values","setValue","bind","setInitialValue","setPendingValue","setTouched","setVisited","setFocused","submit","getInitialState","children","defaultProps","getDerivedStateFromProps","_props","defaultStateProviderProp","config","render","React.createElement","FormWrapper","actions","submitFailed","submitSucceeded","hasErrors","hasSubmitErrors","hasWarnings","Form","stateProvider","context","_lastSetActions","renderWrapper","Wrapper","parsedPath","formattedPath","initialValueState","pendingValueState","touchedMap","visitedMap","warning","FieldWrapper","format","parse","compare","checkbox","initialValue","pendingValue","addField","removeField","dirty","detached","hasError","hasWarning","focus","visit","touch","change","parsedValue","input","composeInput","userProps","onFocus","onBlur","onChange","arrayActions","Field","v","otherValue","FieldArrayWrapper","fieldValue","initialValues","pendingValues","warnings","renderField","getFieldKey","fields","parsedFieldPath","FieldArray","stateValue","withField","propName","Component","WithField","fieldProps","hoistStatics"],"mappings":"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"}